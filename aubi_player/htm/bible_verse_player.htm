<!DOCTYPE html>
<html>
<base target="_blank" />
<META http-equiv="Content-Type" content="text/html;" charset="UTF-8">
<META name="viewport" content="width=device-witdh, initial-scale=1, maximum-scale=1, user-scale=0">

<head>
  <title>AudioBible</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
  <META name="viewport" content="width=device-witdh, initial-scale=1, maximum-scale=1, user-scale=0">
  </META>
  <script src="https://wdingbox.github.io/ham12/jq/jquery-2_1_3.min.js"></script>

  <script src="https://wdingbox.github.io/bible_obj_lib/jsdb/jsBibleObj/NIV.json.js"></script>
  <script
    src="https://wdingbox.github.io/bible_obj_lib/jsdb/jsBibleVerseAudioRelativePos/VrsAudioRelativePosLen_NIV.json.js?v=2"></script>
  <script
    src="https://wdingbox.github.io/bible_obj_lib/jsdb/jsBibleVerseAudioRelativePos/Audio_Bible_Struct.js"></script>


  <script src="../jq/TimeFormatConverter.js"></script>
  <script src="./bible_verse_player.js?v=3"></script>
  <script src="../js/meta/VrsAudioOffsets_NIV.js"></script>

  <style>
    body {}

    thead {
      display: block;
    }

    #myAudioFileNameSelect table,
    #myAudioFileNameSelect tr {
      width: 100%;
    }

    #myAudioFileNameSelect tbody {
      height: 300px;

      overflow-y: scroll;
      display: block;
    }

    #dbg {
      height: 100px;
      background-color: honeydew;

      overflow-y: scroll;
      display: block;
    }


    input.metadat {
      width: 80px;
    }

    input.adj {
      width: 50px;
    }

    .sright {
      width: 100%;
      text-align: right;
    }

    #playedBoard {
      background-color: rgb(241, 245, 245);

      height: 200px;

      overflow-y: scroll;
      display: block;
    }

    .playedItem {
      border: solid grey;
      border-width: 1px;
    }

    .playedbcv {
      padding-left: 1px;
      padding-right: 1px;

      font-size: small;
      font-weight: bold;
      color: blue;
    }

    .hiliscrollview {
      border-width: 5px;
      border-color: blue;
    }

    .hili {
      background-color: red;
    }

    .hili_offsets {}

    .startime {
      background-color: yellowgreen;
    }

    .spantime {
      background-color: lightcoral;
    }

    .playingvrs,
    #DeletePlayingItem {
      background-color: lightgreen;
    }


    .loop_status {
      border: solid blue;
    }

    #show_stop_time {
      display: inline-block;
      white-space: nowrap;
    }

    #filename {
      width: 99%;
      position: fixed;
      top: 0px;
    }

    #txa {
      width: 99%;
    }

    #ctrpanel {
      position: fixed;
      background-color: lightgrey;
      margin-top: 0px;
      top: 2px;
      right: 10px;
    }
  </style>
  <script language="javascript">

    $(function () {

      $(".plusnum").on("click", function () {
        var inp = $(this).parent().find("input:eq(0)")
        var val = inp.val()
        inp.val(parseFloat(val) + 1)
        update_offsets_data()
      })

      $(".minusnum").on("click", function () {
        var inp = $(this).parent().find("input:eq(0)")
        var val = inp.val()
        inp.val(parseFloat(val) - 1)
        update_offsets_data()
      })


      $("#start_loop").on("click", function () {
        loop_start()
        $(".loop_status").removeClass("loop_status")
        $(this).addClass("loop_status")
      })

      $("#stop_loop").on("click", function () {
        loop_stop()
        $(".loop_status").removeClass("loop_status")
        $(this).addClass("loop_status")
      })



      /////
      $("#search_BkChp").on("keyup", function (evt) {
        var val = $(this).val()
        if (13 === evt.keyCode) {
          $("#Scroll2view").trigger("click")
        }
      })

      $("#Scroll2view").on("click", function () {
        var val = $("#search_BkChp").val()
        if (val.length < 3) return alert("not a correst book name code")
        if (val.length === 3) val += "1:1"
        if (val.length > 3 && val.indexOf(":") < 0) val += ":1"
        var items = $(`a.vrsItm[title='${val}']`)
        if (!items || items.length === 0) return alert("cannot find " + val)
        items[0].scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'start' }); //bottom
        items.addClass("hili")
      })//////////


    })

    function speedup(dlt) {
      var cur = parseFloat($("#speed").text()) + dlt
      $("#speed").text(cur)
    }


  </script>

<body>
  <xxinput id="filename" value="" size="100"></xxinput>
  <div id="ctrpanel">

    <audio id="myAudio" controls autoplay="true" width="400" height="100">
      <source src="" type="audio/ogg">
      <source src="" type="audio/mpeg">
      Your browser does not support the audio element.
    </audio>
    <hr />




    <button id="stop_loop">stop</button>
    <button id="start_loop">loop</button>

    <button id="speedup" onclick="speedup(0.25);">+</button>
    <button id="speeddn" onclick="speedup(-0.25);">-</button>
    <a>x </a><a id="speed">1.0</a>


    <br>
    <a id="show_stop_time"></a>

    <br>



    <table>
      <tr>
        <td>
          <div class="sright">start</div>
        </td>
        <td>
          <input class="metadat startime" id="start_float"
            onclick="$('#show_stop_time').text(TimeFormatConverter.convert_seconds_to_hhmmss($(this).val()));"
            value="0.0" title="in seconds"></input>
        </td>
        <td>
          <button onclick="delta_offset(1,0);">+</button>
          <button onclick="delta_offset(-1,0)">-</button>
          <input class="adj" id="offset_star" value="0" type="number"></input>
        </td>
      </tr>

      <tr>
        <td>
          <div class="sright">span</div>
        </td>
        <td>
          <input class="metadat spantime" id="durat_float" value="0"
            onclick="$('#show_stop_time').text(TimeFormatConverter.convert_seconds_to_hhmmss($(this).val()));"></input>
        </td>
        <td>
          <button onclick="delta_offset(0,1);">+</button>
          <button onclick="delta_offset(0,-1)">-</button>
          <input class="adj" id="offset_span" value="0" type="number"></input>
        </td>
        <td><a id="maxlen"></a></td>
      </tr>

    </table>


  </div>










  <table id="selecteditemhistory" border="1" style="margin-top: 200px;">
    <tbody id="playedBoard"></tbody>
  </table>



  <button id="store_offsets" title="store offsets">localSave</button>
  <button id="localClear" title="clear all local saved data.">localClear</button>
  <hr />
  <button id="Bk_Chp_gen">GenBibleTable</button>
  <button id="DeletePlayingItem" onclick="RemovePlayingItemFromPlayedBoard()">Remove</button>

  <input id="search_BkChp" placeholder="Psm121" list="PulldownItems">
  <datalist id="PulldownItems">
    <option value="Gen1">
    <option value="Firefox">
    <option value="Chrome">
    <option value="Opera">
    <option value="Safari">
  </datalist>
  <script>
    $(function () {
      var slst = ""
      Object.keys(BkID_to_AudioName).forEach(function (key) {
        slst += `<option value='${key}'>`
      })
      $("#PulldownItems").html(slst)


      $("#store_offsets").on("click", function () {
        localStorage_playOffsets.save_all()
      })


      $("#localClear").click(function () {
        if (confirm("Are you sure to clear data?")) {
          localStorage_playOffsets.clear_all()
        }
      })
    })
  </script>
  </input>
  <button id="Scroll2view" title="store offsets">Scroll2view</button>

  <textarea id="txa"></textarea>



  <table id="myAudioFileNameSelect" border='1'>
    <thead>
      <th>Bk_Chp</th>
      <th>Verses</th>
    </thead>
    <tbody></tbody>
  </table>

  <br>
  <div id="dbg">dbg</div>
  <br>


</body>

</html>